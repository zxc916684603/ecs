# 灾备方案 {#concept_qzk_qjv_xfb .concept}

保障企业业务稳定、IT系统功能正常、数据安全十分重要，可以同时保障数据备份与系统、应用容灾的灾备解决方案应势而生，且发展迅速。ECS可使用快照、镜像进行备份。

## 灾备设计 {#section_ogk_ynv_xfb .section}

-   **快照备份**

    阿里云ECS可使用快照进行系统盘、数据盘的备份。目前，阿里云提供快照2.0服务，提供了更高的快照额度、更灵活的自动任务策略，并进一步降低了对业务I/O的影响。使用快照进行备份时，第一次备份为全量备份，后续为增量备份，备份所需时间与待备份数据量有关。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/9575/15474455685243_zh-CN.jpg)

    例如，快照1、快照2和快照3分别是磁盘的第一个、第二个和第三个快照。文件系统对磁盘的数据进行分块检查，当创建快照时，只有变化了的数据块，才会被复制到快照中。阿里云ECS的快照备份可配置为手动备份，也可配置为自动备份。配置为自动备份后可以指定磁盘自动创建快照的时间（24个整点）、重复日期（周一到周日）和保留时间（可自定义，范围是1-65536天，或选择永久保留）。

-   **快照回滚**

    当系统出现问题，需要将一块磁盘的数据回滚到之前的某一时刻，可以通过[快照回滚](../intl.zh-CN/用户指南/云盘/回滚云盘.md#)实现，前提是该磁盘已经创建了快照。注意：

    -   回滚磁盘是不可逆操作，一旦回滚完成，原有的数据将无法恢复，请谨慎操作。

    -   回滚磁盘后，从所使用的快照的创建日期到当前时间这段时间内的数据都会丢失。

-   **镜像备份**

    镜像文件相当于副本文件，该副本文件包含了一个或多个磁盘中的所有数据，对于ECS而言，这些磁盘可以是单个系统盘，也可以是系统盘加数据盘的组合。使用镜像备份时，均是全量备份，且只能手动触发。

-   **镜像恢复**

    阿里云ECS支持使用快照创建自定义镜像，将快照的操作系统、数据环境信息完整的包含在镜像中。然后使用自定义镜像创建多台具有相同操作系统和数据环境信息的实例。ECS的快照与镜像配置请参考[快照](../intl.zh-CN/用户指南/快照/创建快照.md#)与[镜像](../intl.zh-CN/用户指南/镜像/创建自定义镜像/使用快照创建自定义镜像.md#)。

    **说明：** 创建的自定义镜像不能跨地域使用。


## 技术指标 {#section_lzx_ynv_xfb .section}

RTO和RPO：与数据量大小有关，通常而言是小时级别。

## 应用场景 {#section_qq5_znv_xfb .section}

-   **备份恢复**

    阿里云ECS可通过快照与镜像对系统盘、数据盘进行备份。如果存储在磁盘上的数据本身就是错误的数据，比如由于应用错误导致的数据错误，或者黑客利用应用漏洞进行恶意读写，此时就可以使用快照服务将磁盘上的数据恢复到期望的状态。另外ECS可通过镜像重新初始化磁盘或使用自定义镜像新购ECS实例。

-   **容灾应用**

    ECS可以从架构上来实现容灾场景下的应用，比如：在应用前端购买SLB产品，后端相同应用部署至少两台ECS服务器，或者是使用阿里云的弹性伸缩技术，根据自定义ECS自身资源的使用规则来进行弹性扩容。这样即便其中一台ECS服务器故障或者资源利用超负荷，也不会使服务对外终止，从而实现容灾场景下的应用。以同城两机房部署ECS集群为例：

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/65023/154744556834740_zh-CN.png)

    -   ECS在两机房均部署集群，接入侧通过SLB做两机房的接入流量负载均衡。
    -   两机房部署的Region Master节点是对等的，单Region Master节点故障不影响ECS的管控功能。
    -   ECS的管控节点机房级故障切换，主要是对管控集群依赖的中间件域名重新绑定。如管控节点机房级故障，需重新将中间件域名绑定至另一个机房的管控节点。

